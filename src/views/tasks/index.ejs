<div class="card">
    <div class="card-header d-flex justify-content-between align-items-center">
        <h2 class="mb-0">
            <i class="bi bi-list-task me-2"></i>
            Minhas Tarefas
        </h2>
        <a href="/tasks/create" class="btn btn-primary">
            <i class="bi bi-plus-circle me-2"></i>
            Nova Tarefa
        </a>
    </div>
    
    <div class="card-body">
        <div class="filters">
            <a href="/tasks" class="filter-btn <%= !currentStatus ? 'active' : '' %>">
                <i class="bi bi-collection me-1"></i>
                Todas
            </a>
            <a href="/tasks?status=PENDING" class="filter-btn <%= currentStatus === 'PENDING' ? 'active' : '' %>">
                <i class="bi bi-clock me-1"></i>
                Pendentes
            </a>
            <a href="/tasks?status=IN_PROGRESS" class="filter-btn <%= currentStatus === 'IN_PROGRESS' ? 'active' : '' %>">
                <i class="bi bi-arrow-repeat me-1"></i>
                Em Andamento
            </a>
            <a href="/tasks?status=COMPLETED" class="filter-btn <%= currentStatus === 'COMPLETED' ? 'active' : '' %>">
                <i class="bi bi-check-circle me-1"></i>
                Concluídas
            </a>
        </div>

        <% if (tasks && tasks.length > 0) { %>
            <!-- Estatísticas -->
            <div class="row mb-4">
                <div class="col-md-3">
                    <div class="stats-card">
                        <div class="stats-number"><%= tasks.filter(t => t.status === 'PENDING').length %></div>
                        <div class="stats-label">Pendentes</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="stats-card">
                        <div class="stats-number"><%= tasks.filter(t => t.status === 'IN_PROGRESS').length %></div>
                        <div class="stats-label">Em Andamento</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="stats-card">
                        <div class="stats-number"><%= tasks.filter(t => t.status === 'COMPLETED').length %></div>
                        <div class="stats-label">Concluídas</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="stats-card">
                        <div class="stats-number"><%= tasks.length %></div>
                        <div class="stats-label">Total</div>
                    </div>
                </div>
            </div>

            <div class="task-grid">
                <% tasks.forEach(task => { %>
                    <div class="task-card" data-task-id="<%= task.id %>">
                        <div class="task-header">
                            <div>
                                <div class="task-title">
                                    <i class="bi bi-check2-square me-2"></i>
                                    <%= task.title %>
                                </div>
                                <div class="task-status status-<%= task.status.toLowerCase().replace('_', '-') %>">
                                    <i class="bi bi-<%= task.status === 'PENDING' ? 'clock' : task.status === 'IN_PROGRESS' ? 'arrow-repeat' : 'check-circle' %> me-1"></i>
                                    <%= task.status === 'PENDING' ? 'Pendente' : 
                                        task.status === 'IN_PROGRESS' ? 'Em Andamento' : 'Concluída' %>
                                </div>
                            </div>
                        </div>

                        <% if (task.description) { %>
                            <div class="task-description">
                                <i class="bi bi-text-paragraph me-2"></i>
                                <%= task.description %>
                            </div>
                        <% } %>

                        <div class="task-meta">
                            <div class="row">
                                <div class="col-6">
                                    <i class="bi bi-calendar-plus me-1"></i>
                                    <strong>Criada:</strong> <%= moment(task.createdAt).format('DD/MM/YYYY HH:mm') %>
                                </div>
                                <% if (task.dueDate) { %>
                                    <div class="col-6">
                                        <i class="bi bi-calendar-event me-1"></i>
                                        <strong>Vencimento:</strong> <%= moment(task.dueDate).format('DD/MM/YYYY') %>
                                    </div>
                                <% } %>
                            </div>
                        </div>

                        <div class="task-actions">
                            <% if (task.status !== 'COMPLETED') { %>
                                <button onclick="updateTaskStatus(<%= task.id %>, 'COMPLETED')" class="btn btn-success btn-sm">
                                    <i class="bi bi-check-circle me-1"></i>
                                    Concluir
                                </button>
                            <% } %>
                            
                            <% if (task.status === 'PENDING') { %>
                                <button onclick="updateTaskStatus(<%= task.id %>, 'IN_PROGRESS')" class="btn btn-warning btn-sm">
                                    <i class="bi bi-arrow-repeat me-1"></i>
                                    Em Andamento
                                </button>
                            <% } %>

                            <a href="/tasks/<%= task.id %>/edit" class="btn btn-primary btn-sm">
                                <i class="bi bi-pencil me-1"></i>
                                Editar
                            </a>

                            <button onclick="confirmDelete(<%= task.id %>)" class="btn btn-danger btn-sm">
                                <i class="bi bi-trash me-1"></i>
                                Excluir
                            </button>
                        </div>
                    </div>
                <% }) %>
            </div>
        <% } else { %>
            <div class="empty-state">
                <div class="icon">
                    <i class="bi bi-inbox"></i>
                </div>
                <h3>Nenhuma tarefa encontrada</h3>
                <p class="mb-4">Comece criando sua primeira tarefa para organizar suas atividades!</p>
                <a href="/tasks/create" class="btn btn-primary btn-lg">
                    <i class="bi bi-plus-circle me-2"></i>
                    Criar Primeira Tarefa
                </a>
            </div>
        <% } %>
    </div>
</div> 